---
layout: blog_post
title: 椭圆的极坐标表示
---

高中解析几何中学过，椭圆的标准方程

$$
\frac{x^2}{a^2} + \frac{y^2}{b^2} = 1
$$

可以确定一组满足上式的点$$(x, y)$$，所有这些$$(x, y)$$就构成了一个椭圆。拿到这样一个方程，我们可以观察到$$x$$坐标一定在$$[-a, a]$$的范围之内（$$a > 0$$），当$$y = 0$$时$$x$$取得最大/最小值。同样的道理，$$y$$在$$[-b, b]$$之间取值（$$b > 0$$），当$$x=0$$时取得最大/最小值。若假定$$a > b$$则可大致想象到这个方程描述的形状，大约是一个扁长的形状，$$x$$轴较长，且在$$x$$轴上达到向两个方向延伸的最远端，$$y$$轴稍短，但同样在$$y$$轴上达到上下延伸的最远端，而且四个象限都对称。

椭圆的长轴上有两个特殊的点称为“焦点”，左右对称，两边各一个。这两个焦点有一些特殊的性质，比如椭圆上每一个点到两个焦点的距离之和为一个恒定的常量。而且，以其中一个焦点作为原点，可以将椭圆的方程写为用$$(r, \theta)$$的极坐标表示的形式如下

$$
r = \frac{p}{1 + e \cos \theta}
$$

其中$$p$$和$$e$$为参数且$$0 \le e < 1$$，$$r$$和$$\theta$$为变量。$$r$$是轨迹上一点到原点的距离，$$\theta$$是该点到原点的连线转过的角度（从$$x$$轴正方向逆时针旋转的角度）。

为什么椭圆也可以写成这样的形式呢？这个极坐标表示形式和椭圆标准方程等价吗？这并不是一个容易回答的问题。今天这篇我们就来看看这两个表示形式是怎么联系起来的。

根据上面关于$$r$$和$$\theta$$的定义，若设我们在极坐标中选作原点的椭圆焦点在以椭圆中心为坐标的坐标系（亦即标准方程中的坐标系）中的坐标为$$(a_0, 0)$$，那么根据定义，我们有

$$
\begin{align*}
  x &= r\cos\theta + a_0 \\
  y &= r\sin\theta
\end{align*}
$$

我们的目标是，给定椭圆的极坐标表达式以及上面的变换式，找到$$a$$和$$b$$，使得上面定义的$$x$$和$$y$$也满足椭圆的标准方程。

首先我们可以观察一下上面给出的极坐标方程，$$r$$的极值为

$$
r_\min = \frac{p}{1 + e}, \qquad r_\max = \frac{p}{1 - e}
$$

分别在$$\theta=0$$和$$\theta=\pi$$也就是$$x$$轴上的两个端点处取得。椭圆的长轴长度为$$2a$$，因此可得

$$
a = \frac{1}{2}(r_\min + r_\max) = \frac{1}{2}\frac{2p}{1-e^2} = \frac{p}{1 - e^2}.
$$

又由定义可知

$$
a_0 + r_\min = a
$$

所以

$$
a_0 = a - r_\min = \frac{p}{1 - e^2} - \frac{p}{1 + e} = \frac{ep}{1-e^2} = ea.
$$

接下来我们来看$$y$$方向，从$$r$$的极坐标表示，可得

$$
r + er\cos\theta = p
$$

再结合$$y$$的变换式，可得

$$
(ey)^2 + (p - r)^2 = (er\sin\theta)^2 + (er\cos\theta)^2 = (er)^2
$$

因此

$$
\begin{align*}
(ey)^2 &= (er) - (p - r)^2 = (er + p - r)(er - p + r) = [p - (1 - e)r][(1 + e)r - p] \\
&= (1-e^2)\left[\frac{p}{1 - e} - r\right]\left[r - \frac{p}{1 + e}\right] \\
&= (1-e^2)(r_\max - r)(r - r_\min) \\
&\le (1 - e^2)\left(\frac{r_\max + r_\min}{2}\right)^2 \\
&= a^2(1 - e^2)
\end{align*}
$$

从而

$$
|y| \le a \sqrt{1 - e^2} = \frac{p}{\sqrt{1 - e^2}}
$$

也就是说

$$
b = a \sqrt{1 - e^2} = \frac{p}{\sqrt{1 - e^2}}
$$

如果这个极坐标表达式表示一个椭圆，那么这个椭圆的$$a, b$$参数就必须是上面给出的形式。

最后，我们尝试将$$r,\theta$$消去，得到一个仅表示$$x,y$$之间关系的表达式，看看是否能得到椭圆的标准方程。根据$$x,y$$变换式，我们有

$$
(x - a_0)^2 + y^2 = r^2
$$

再由轨迹的极坐标表达式，可得

$$
r = p - re\cos\theta = p - e(x - a_0)
$$

消去$$r^2$$可得$$x,y$$之间的关系式

$$
(x - a_0)^2 + y^2 = [p - e(x - a_0)]^2
$$

我们已经知道$$a_0 = ea$$以及$$a = \frac{p}{1 - e^2}$$，上面等式右边平方之内的项于是可以变为

$$
p - ex + ea_0 = p - ex + \frac{e^2p}{1 - e^2} = \frac{p}{1 - e^2} - ex = a - ex
$$

再将上式及$$a_0 = ea$$带入回$$x,y$$关系式，得到

$$
\begin{align*}
(x - ea)^2 + y^2 &= (a - ex)^2 \\
x^2 - 2eax + e^2a^2 + y^2 &= a^2 - 2eax + e^2x^2 \\
x^2(1 - e^2) + y^2 &= a^2(1 - e^2) \\
\frac{x^2}{a^2} + \frac{y^2}{a^2(1 - e^2)} &= 1
\end{align*}
$$

这就是椭圆的标准方程，并且这里$$b=a\sqrt{1 - e^2}$$，符合我们之前已经推导过的结论。因此，最开始我们看到的极坐标表示的曲线和椭圆标准方程表示的是不同坐标系中的同一条曲线，一个椭圆。

从椭圆标准方程也可以反推得到极坐标表达式。例如我们可以根据$$b=a\sqrt{1 - e^2}$$得出

$$
e = \sqrt{1 - \frac{b^2}{a^2}}
$$

再根据$$a = \frac{p}{1 - e^2}$$可得

$$
p = a(1 - e^2) = \frac{b^2}{a}
$$

将$$x = r\cos\theta - ea$$及$$y = r\sin\theta$$带入椭圆的标准方程$$\frac{x^2}{a^2} + \frac{y^2}{b^2} = 1$$可以得到$$r$$和$$\theta$$的关系式，感兴趣的读者可以自己试着推导一下。

***

最后，我们来推导椭圆的另一个定义，即在一个平面上到固定两点距离之和为定值的点构成的曲线。这两个点就是椭圆的焦点，它们所在的直线就是椭圆长轴对应的直线。如果这个定义成立，那么我们可以观察得出这个距离之和的定值。我们可以选择当这个点恰好在$$x$$轴的情况，例如这个点正好在$$(a, 0)$$这个点，那么它到两个焦点的距离就是$$(a - ea) + (a + ea) = 2a$$。因此若这个定义成立，椭圆上每个点到两个焦点的距离之和都是$$2a$$。另一个特殊情况是当这个点在$$y$$轴上，例如在$$(0, b)$$处，这时该点到两个焦点的距离之和为$$2\sqrt{b^2 + e^2a^2} = 2\sqrt{a^2(1 - e^2) + e^2a^2} = 2a$$，也是成立的。

接下来我们证明“椭圆上任意一点到两焦点的距离之和为$$2a$$”这个性质总是成立。

在极坐标中，椭圆上一点$$(r, \theta)$$已经给出了到一个焦点的距离$$r$$，我们只需要求得到另一个焦点的距离，再看他们二者的和是否为定值。我们知道在椭圆标准方程坐标系中，极坐标原点也即$$x$$轴正方向的焦点的坐标为$$(ea, 0)$$，对应的另一个焦点的坐标为$$(-ea, 0)$$，椭圆上点在这个坐标系的坐标为$$(ea + r\cos\theta, r\sin\theta)$$，因此其到另一个焦点距离的平方为

$$
\begin{align*}
& (2ea + r\cos\theta)^2 + (r\sin\theta)^2 \\
=& r^2\cos^2\theta + 4ea r\cos\theta + 4e^2a^2 + r^2\sin^2\theta \\
=& r^2 + 4a re\cos\theta + 4e^2a^2 \\
=& r^2 + 4a (p - r) + 4e^2a^2 \\
=& r^2 - 4ar + 4a p + 4e^2 a^2 \\
=& r^2 - 4ar + 4a a(1-e^2) + 4e^2 a^2 \\
=& r^2 - 4ar + 4a^2 \\
=& (r - 2a)^2
\end{align*}
$$

因此这个点到另一个焦点的距离为$$2a - r$$（注意$$r \le r_\max = \frac{p}{1 - e} = a(1 + e) < 2a$$）。从而这个点到两个焦点的距离之和为

$$
r + (2a - r) = 2a.
$$

这是一个与该点位置无关的常量。